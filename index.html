<!DOCTYPE html>
<html lang="zh-HK">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>TKOH åŸ¹è¨“ç®¡ç†ç³»çµ±</title>
  
  <!-- ä¿®æ­£ï¼šåŠ å…¥ favicon -->
  <link rel="icon" href="data:,">
  
  <style>
    /* ä½ çš„ CSS ä¿æŒä¸è®Š */
  </style>
</head>
<body>
  <div class="container">
    <!-- ä½ çš„ HTML ä¿æŒä¸è®Š -->
  </div>

  <script>
    // ========== æ¸¬è©¦å„²å­˜åŠŸèƒ½ ==========
    async function testSave() {
      console.log('ğŸ§ª é–‹å§‹æ¸¬è©¦å„²å­˜...');
      
      const testStaff = {
        id: 'test001',
        name: 'æ¸¬è©¦å“¡å·¥',
        records: [
          { name: 'æ¸¬è©¦é …ç›®1', completed: true, date: '2025-03-11' },
          { name: 'æ¸¬è©¦é …ç›®2', completed: false, date: null }
        ]
      };
      
      if (window.saveToFirebase) {
        await window.saveToFirebase(testStaff);
        showToast('âœ… æ¸¬è©¦å„²å­˜å®Œæˆï¼è«‹æª¢æŸ¥ Firebase Console');
      } else {
        alert('âŒ Firebase å°šæœªåˆå§‹åŒ–');
      }
    }
    
    // ä½ çš„å…¶ä»–å‡½æ•¸ä¿æŒä¸è®Š...
    
    // ========== ä¿®æ­£ï¼šåˆ‡æ›åŸ¹è¨“è¨˜éŒ„ç‹€æ…‹ ==========
    async function toggleRecord(index) {
      const staff = staffList.find(s => s.id === currentStaffId);
      const record = staff.records[index];
      
      record.completed = !record.completed;
      record.date = record.completed ? new Date().toISOString().split('T')[0] : null;
      
      showToast(record.completed ? 'âœ… å·²å®Œæˆ' : 'â³ å·²å–æ¶ˆå®Œæˆ');
      
      // å„²å­˜åˆ° Firebase
      if (window.db && window.saveToFirebase) {
        try {
          await window.saveToFirebase(staff);
          console.log('âœ… è‡ªå‹•å„²å­˜æˆåŠŸ');
        } catch (error) {
          console.error('âŒ è‡ªå‹•å„²å­˜å¤±æ•—:', error);
          showToast('âš ï¸ å„²å­˜å¤±æ•—ï¼Œè«‹é‡è©¦', '#e74c3c');
        }
      }
      
      // é‡æ–°é¡¯ç¤º
      showStaff(currentStaffId);
    }
    
    // å…¶ä»–å‡½æ•¸ä¿æŒä¸è®Š...
  </script>

  <!-- Firebase SDK -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
    import { 
      getFirestore, 
      collection, 
      doc, 
      setDoc,
      getDocs
    } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js";

    // ä½ çš„ firebaseConfig ä¿æŒä¸è®Š...
    const firebaseConfig = {
      apiKey: "AIzaSyDDkALOTGl6fZunGU_Xd5FOy45WnXZWT8E",
      authDomain: "tkoh-ot-training-system.firebaseapp.com",
      projectId: "tkoh-ot-training-system",
      storageBucket: "tkoh-ot-training-system.firebasestorage.app",
      messagingSenderId: "1027139549127",
      appId: "1:1027139549127:web:b987293382058a54d08be2"
    };

    console.log('ğŸ”§ æ­£åœ¨åˆå§‹åŒ– Firebase...');
    const app = initializeApp(firebaseConfig);
    window.db = getFirestore(app);
    console.log('âœ… Firebase åˆå§‹åŒ–æˆåŠŸï¼');
    
    // ä½ çš„ saveToFirebase å’Œ loadFromFirebase ä¿æŒä¸è®Š...
    
    window.addEventListener('load', async () => {
      console.log('ğŸš€ ç³»çµ±å•Ÿå‹•ä¸­...');
      await window.loadFromFirebase();
      console.log('âœ… ç³»çµ±å°±ç·’ï¼');
    });
  </script>
</body>  <!-- ä¿®æ­£ï¼šåªä¿ç•™ä¸€å€‹ </body> -->
</html>
